(()=>{var E=Object.defineProperty,z=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var P=(e,n,t)=>n in e?E(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,f=(e,n)=>{for(var t in n||(n={}))W.call(n,t)&&P(e,t,n[t]);if(J)for(var t of J(n))$.call(n,t)&&P(e,t,n[t]);return e},m=(e,n)=>z(e,G(n));function w(){console.log("%cLucead","background:#444;color:#4EA05D;border-radius:4px;padding:2px",...arguments)}function b(){console.error("%cLucead","background:#444;color:#4EA05D;border-radius:4px;padding:2px",...arguments)}var D="v0412.1",B=1200,F=!1;function H(){let e=document.createElement("script");e.src="https://s.lucead.com/tag/2747166919.js",top.document.body.appendChild(e)}async function S(e,n={}){let{timeout:t=B}=n,l=new AbortController,a=setTimeout(()=>l.abort(),t),i=await fetch(e,m(f({},n),{signal:l.signal}));return clearTimeout(a),i}function T(e){return e?e.includes("<html")?e:`<html lang="en"><body style="margin:0;background-color:#FFF">${e}</body></html>`:null}function v(e,n){var l,a,i,r,s,d,p,h;let t=e.ortbConverter({}).toORTB({bidRequests:[n],bidderRequest:e.bidderRequest});if(e.consent&&e.deepSetValue&&(e.deepSetValue(t,"user.ext.consent",(l=e==null?void 0:e.consent)==null?void 0:l.tcString),e.deepSetValue(t,"regs.ext.gdpr",(a=e==null?void 0:e.consent)!=null&&a.gdprApplies?1:0)),(i=t.imp)!=null&&i.length)for(let c of t.imp)c.banner.w=n.sizes[0][0],c.banner.h=n.sizes[0][1];return(r=t==null?void 0:t.site)!=null&&r.page&&((s=t==null?void 0:t.site)!=null&&s.page.includes("://"))&&(t.site.page=encodeURIComponent(t.site.page)),(p=(d=t==null?void 0:t.source)==null?void 0:d.ext)!=null&&p.wrapper||(e.deepSetValue(t,"source.ext.wrapper","Prebid_js"),e.deepSetValue(t,"source.ext.wrapper_version",(e==null?void 0:e.prebid_version)||((h=window==null?void 0:window.pbjs)==null?void 0:h.version))),n!=null&&n.userIdAsEids&&e.deepSetValue(t,"user.ext.eids",n.userIdAsEids),t}function k(e,n,t=null,l=null){var r;if(!((r=e==null?void 0:e.seatbid)!=null&&r.length))return null;let a=e.seatbid[0].bid.filter(s=>s&&s.price>0&&s.adm&&s.w===n.width&&s.h===n.height);a.sort((s,d)=>d.price-s.price);let i=a[0];return i!=null&&i.price&&location.hostname!=="www.virtuafoot.com"&&!location.hostname.endsWith(".ngrok-free.app")&&fetch("https://lucead.com/log",{method:"POST",body:JSON.stringify({bid:i,result:e,ssp:t,version:D,placement:l})}),{cpm:(i==null?void 0:i.price)||0,currency:e.cur||"USD",ad:T((i==null?void 0:i.adm)||null),size:{width:(i==null?void 0:i.w)||n.width,height:(i==null?void 0:i.h)||n.height},ssp:t,advertiser_domains:(i==null?void 0:i.adomain)||null}}async function L(){return new Promise(e=>{window.__tcfapi?window.__tcfapi("getTCData",2,(n,t)=>{e(t?n:null)}):e(null)})}async function M(e){try{return await fetch(`${e.static_url}/placements/info?ids=`+e.bidRequests.map(n=>n==null?void 0:n.params.placementId).join(",")).then(n=>n.json())}catch(n){return null}}async function Q({base_url:e,size:n,placement_id:t,bidRequest:l,bidderRequest:a}){e||(e="https://lucead.com");let i=e.endsWith("lucead.com")?"https://ayads.io":e,r={seller:i,decisionLogicUrl:`${i}/js/ssp.js`,interestGroupBuyers:[i],auctionSignals:{size:n,placement_id:t},sellerSignals:{},sellerTimeout:1e3,sellerCurrency:"EUR",perBuyerSignals:{[i]:{prebid_bid_id:l.bidId,prebid_request_id:a.bidderRequestId,placement_id:t}},perBuyerTimeouts:{"*":1e3},resolveToConfig:!1,dataVersion:2},s;if(!navigator.runAdAuction||location.hash.includes("skip-pa")?s=null:s=await navigator.runAdAuction(r),s){if(F){let d=document.createElement("iframe");d.src=s,d.style.display="none",document.body.appendChild(d),d.remove()}return{bid_id:l.bidId,ad:T(`<iframe src="${s}" style="width:${n.width}px;height:${n.height}px;border:none" seamless ></iframe>`),size:n,is_pa:!0,placement_id:t}}else return null}async function X(e){let n=e.placements_info;return await Promise.all(e.bidRequests.map(async t=>{var i,r,s,d,p,h,c,j,C,U,A,N;let l={bid_id:t.bidId,bid:0,ad:null,size:null,placement_id:e.placement_id};if(((i=t==null?void 0:t.params)==null?void 0:i.enableContextual)===!1)return l;let a={width:t.sizes[0][0]||300,height:t.sizes[0][1]||250};try{let g=(r=t==null?void 0:t.params)==null?void 0:r.placementId;if(!g)return l;let V=await Q(m(f({},e),{size:a,placement_id:g,data:e,bidRequest:t}));if(V)return V;let o=n[g]||null;if(!(o!=null&&o.ssps))return w("No placement info",g,n),l;let _=[];if((s=o==null?void 0:o.ssps)!=null&&s.improve&&_.push(Z(m(f({},e),{size:a,placement_id:(d=o==null?void 0:o.ssps)==null?void 0:d.improve,data:e,bidRequest:t}))),(p=o==null?void 0:o.ssps)!=null&&p.grid&&_.push(K(m(f({},e),{size:a,placement_id:o==null?void 0:o.ssps.grid,deepSetValue:e.deepSetValue,data:e,bidRequest:t}))),(h=o==null?void 0:o.ssps)!=null&&h.smart&&_.push(R(m(f({},e),{sizes:t.sizes,size:a,placement_id:(c=o==null?void 0:o.ssps)==null?void 0:c.smart,transaction_id:t.transactionId,bid_id:t.bidId,ad_unit_code:t.adUnitCode,deepSetValue:e.deepSetValue,data:e,bidRequest:t}))),(j=o==null?void 0:o.ssps)!=null&&j.pubmatic&&_.push(q(m(f({},e),{size:a,placement_id:(C=o==null?void 0:o.ssps)==null?void 0:C.pubmatic,transaction_id:t.transactionId,bid_id:t.bidId,ad_unit_code:t.adUnitCode,data:e,bidRequest:t}))),(U=o==null?void 0:o.ssps)!=null&&U.magnite&&_.push(ee(m(f({},e),{size:a,placement_id:(A=o==null?void 0:o.ssps)==null?void 0:A.magnite,ad_unit_code:t.adUnitCode,data:e,bidRequest:t,placement:o}))),!_.length)return l;let u=await Promise.all(_);if(u===null||!(u!=null&&u.length))return l;if(u=u.filter(y=>y&&y.cpm),u!=null&&u.length){(N=u[0])!=null&&N.is_pa||u.sort((I,O)=>((O==null?void 0:O.cpm)||0)-((I==null?void 0:I.cpm)||0));let y=u[0];return y.bid_id=t.bidId,y.size=a,y.placement_id=g,y}else return l}catch(g){return b(g),l}}))}async function Y(e){let n=e.endpoint_url,t=e.request_id,[l,a]=await Promise.all([M(e),L()]);e.consent=a,e.placements_info=l,performance.mark("lucead-start");let i=null;try{i=await X(e)}catch(r){b(r)}performance.mark("lucead-end"),w(D,i,performance.measure("lucead-all-responses","lucead-start","lucead-end")),fetch(`${n}/prebid/pub`,{method:"POST",contentType:"text/plain",body:JSON.stringify({request_id:t,responses:i,is_sra:e.is_sra})}).catch(b)}var x=location.hash.includes("mock");async function Z({data:e,bidRequest:n,prebid_version:t,size:l,placement_id:a}){var s,d;let i=x?"?mock=improve":"https://ad.360yield.com/pb",r=v(e,n);r.imp[0].ext.bidder={placementId:a||22511670},r.ext={improvedigital:{sdk:{name:"pbjs",version:t||"8.32.0"}}};try{performance.mark("lucead-improve-start");let p=await S(i,{method:"POST",contentType:"text/plain",body:JSON.stringify(r)});return p.status!==200||(p=await p.json(),!((d=(s=p==null?void 0:p.seatbid[0])==null?void 0:s.bid[0])!=null&&d.price))?null:(performance.mark("lucead-improve-end"),k(p,l,"improve"))}catch(p){return null}}async function K({size:e,placement_id:n,data:t,bidRequest:l}){let a=x?"?mock=grid":"https://grid.bidswitch.net/hbjson",i=v(t,l);i.imp[0].tagid=n.toString();try{let r=await S(a,{method:"POST",contentType:"text/plain",body:JSON.stringify(i)});return r.status!==200?(w("Grid response not ok",r),null):(r=await r.json(),k(r,e,"grid"))}catch(r){return null}}async function R({placement_id:e,sizes:n,size:t,prebid_version:l,transaction_id:a,bid_id:i,ad_unit_code:r,consent:s}){let d="https://prg.smartadserver.com/prebid/v1",p=e.toString().split(":").map(c=>parseInt(c));if(p.length<3)return null;let h={siteid:p[0]||351627,pageid:p[1]||1232283,formatid:p[2]||88269,ckid:p[3]||0,tagId:r,pageDomain:location.href,transactionId:a,timeout:3e3,bidId:i,prebidVersion:l||"8.37.0",schain:pbjs.getConfig("schain"),gpid:r,sizes:n.map(c=>({w:c[0],h:c[1]})),bidfloor:0,gdpr_consent:(s==null?void 0:s.tcString)||null};try{let c=await S(d,{method:"POST",contentType:"text/plain",body:JSON.stringify(h)});return!c.ok||c.status!==200||c.headers.get("content-length")==="0"?(w("Response not ok",c),null):(c=await c.json(),c?{cpm:(c==null?void 0:c.cpm)||0,currency:(c==null?void 0:c.currency)||"USD",ad:c!=null&&c.ad?T(c.ad):null,size:{width:c.width||t.width,height:c.height||t.height},ssp:"smart"}:null)}catch(c){return null}}async function q({placement_id:e,size:n,data:t,bidRequest:l}){let a=x?"?mock=pubmatic":"https://hbopenbid.pubmatic.com/translator?source=prebid-client",i=v(t,l);i.at=1,i.cur=["USD","EUR"],i.imp[0].tagid=e.toString();try{let r=await S(a,{method:"POST",contentType:"text/plain",body:JSON.stringify(i)});return r.ok?(r=await r.json(),k(r,n,"pubmatic")):(w("Response not ok",r),null)}catch(r){return null}}async function ee({placement_id:e,size:n,ad_unit_code:t,data:l,bidRequest:a,placement:i}){let r=x?"?mock=magnite":"https://prebid-server.rubiconproject.com/openrtb2/auction",s=e.toString().split(":").map(p=>parseInt(p));if(s.length<3)return null;let d=v(l,a);d.imp[0].ext.prebid={bidder:{rubicon:{video:{},accountId:s[0],siteId:s[1],zoneId:s[2]}},adunitcode:t};try{let p=await S(r,{method:"POST",contentType:"text/plain",body:JSON.stringify(d)});return p.ok?(p=await p.json(),k(p,n,"magnite",i)):null}catch(p){return null}}window.ayads_prebid=Y;window.ayads_prebid_data&&(window.ayads_prebid(window.ayads_prebid_data),delete window.ayads_prebid_data);(location.hostname==="www.24h.com.vn"||location.hostname==="localhost")&&H();})();
