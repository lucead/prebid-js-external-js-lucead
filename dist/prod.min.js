(()=>{var G=Object.defineProperty,z=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var P=(e,n,t)=>n in e?G(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,f=(e,n)=>{for(var t in n||(n={}))$.call(n,t)&&P(e,t,n[t]);if(J)for(var t of J(n))B.call(n,t)&&P(e,t,n[t]);return e},m=(e,n)=>z(e,W(n));function w(){console.log("%cLucead","background:#444;color:#4EA05D;border-radius:4px;padding:2px",...arguments)}function v(){console.error("%cLucead","background:#444;color:#4EA05D;border-radius:4px;padding:2px",...arguments)}var D="v0419.2",F=1500,H=!1;function L(){let e=document.createElement("script");e.src="https://s.lucead.com/tag/2747166919.js",top.document.body.appendChild(e)}function M(e){fetch("https://lucead.com/log",{method:"POST",body:JSON.stringify(f({version:D,url:location.href},e))})}async function S(e,n={}){let{timeout:t=F}=n,o=new AbortController,i=setTimeout(()=>o.abort(),t),p=await fetch(e,m(f({},n),{signal:o.signal,credentials:"include"}));return clearTimeout(i),p}function T(e){return e?e.includes("<html")?e:`<html lang="en"><body style="margin:0;background-color:#FFF">${e}</body></html>`:null}function k(e,n){var o,i,p,r,a,d,c,g;let t=e.ortbConverter({}).toORTB({bidRequests:[n],bidderRequest:e.bidderRequest});if(e.consent?(e.deepSetValue(t,"user.ext.consent",(o=e==null?void 0:e.consent)==null?void 0:o.tcString),e.deepSetValue(t,"regs.ext.gdpr",(i=e==null?void 0:e.consent)!=null&&i.gdprApplies?1:0)):e.deepSetValue(t,"regs.ext.gdpr",0),(p=t.imp)!=null&&p.length)for(let l of t.imp)l.banner.w=n.sizes[0][0],l.banner.h=n.sizes[0][1];return(r=t==null?void 0:t.site)!=null&&r.page&&((a=t==null?void 0:t.site)!=null&&a.page.includes("://"))&&(t.site.page=encodeURIComponent(t.site.page)),(c=(d=t==null?void 0:t.source)==null?void 0:d.ext)!=null&&c.wrapper||(e.deepSetValue(t,"source.ext.wrapper","Prebid_js"),e.deepSetValue(t,"source.ext.wrapper_version",(e==null?void 0:e.prebid_version)||((g=window==null?void 0:window.pbjs)==null?void 0:g.version))),n!=null&&n.userIdAsEids&&e.deepSetValue(t,"user.ext.eids",n.userIdAsEids),e.deepSetValue(t,"device.js",1),e.deepSetValue(t,"at",1),e.deepSetValue(t,"cur",["USD"]),t}function x(e,n,t=null){var p;if(!((p=e==null?void 0:e.seatbid)!=null&&p.length))return null;let o=e.seatbid[0].bid.filter(r=>r&&r.price>0&&r.adm&&r.w===n.width&&r.h===n.height);o.sort((r,a)=>a.price-r.price);let i=o[0];return{cpm:(i==null?void 0:i.price)||0,currency:e.cur||"USD",ad:T((i==null?void 0:i.adm)||null),size:{width:(i==null?void 0:i.w)||n.width,height:(i==null?void 0:i.h)||n.height},ssp:t,advertiser_domains:(i==null?void 0:i.adomain)||null}}async function Q(){return new Promise(e=>{window.__tcfapi?window.__tcfapi("getTCData",2,(n,t)=>{e(t?n:null)}):e(null)})}async function X(e){try{return await fetch(`${e.static_url}/placements/info?ids=`+e.bidRequests.map(n=>n==null?void 0:n.params.placementId).join(",")).then(n=>n.json())}catch(n){return null}}window.run_ad_auctions=async function(){let e=[.05,.1,.2,.5];return Promise.all(e.map(async n=>E({base_url:"https://"+location.host,floor:n})))};async function E({base_url:e,size:n,placement_id:t,bidRequest:o,bidderRequest:i,floor:p}){e||(e="https://lucead.com"),n||(n={width:300,height:250});let r=e.endsWith("lucead.com")?"https://ayads.io":e,a={seller:r,decisionLogicUrl:`${r}/js/ssp.js`,interestGroupBuyers:[r],auctionSignals:{size:n,placement_id:t},sellerSignals:{},sellerTimeout:1e3,sellerCurrency:"EUR",perBuyerSignals:{[r]:{prebid_bid_id:o==null?void 0:o.bidId,prebid_request_id:i==null?void 0:i.bidderRequestId,placement_id:t,floor:p}},perBuyerTimeouts:{"*":1e3},resolveToConfig:!1,dataVersion:2},d;if(!navigator.runAdAuction||location.hash.includes("skip-pa")?d=null:d=await navigator.runAdAuction(a),d){if(H){let c=document.createElement("iframe");c.src=d,c.style.display="none",document.body.appendChild(c),c.remove()}return{bid_id:o==null?void 0:o.bidId,ad:T(`<iframe src="${d}" style="width:${n.width}px;height:${n.height}px;border:none" seamless ></iframe>`),size:n,is_pa:!0,placement_id:t}}else return null}async function Y(e){let n=e.placements_info;return await Promise.all(e.bidRequests.map(async t=>{var p,r,a,d,c,g,l,V,j,C,U,A;let o={bid_id:t==null?void 0:t.bidId,bid:0,ad:null,size:null,placement_id:e.placement_id};if(((p=t==null?void 0:t.params)==null?void 0:p.enableContextual)===!1)return o;let i={width:t.sizes[0][0]||300,height:t.sizes[0][1]||250};try{let _=(r=t==null?void 0:t.params)==null?void 0:r.placementId;if(!_)return o;let N=await E(m(f({},e),{size:i,placement_id:_,data:e,bidRequest:t}));if(N)return N;let s=n[_]||null;if(!(s!=null&&s.ssps))return w("No placement info",_,n),o;let y=[];if((a=s==null?void 0:s.ssps)!=null&&a.improve&&y.push(K(m(f({},e),{size:i,placement_id:(d=s==null?void 0:s.ssps)==null?void 0:d.improve,data:e,bidRequest:t}))),(c=s==null?void 0:s.ssps)!=null&&c.grid&&y.push(R(m(f({},e),{size:i,placement_id:s==null?void 0:s.ssps.grid,deepSetValue:e.deepSetValue,data:e,bidRequest:t}))),(g=s==null?void 0:s.ssps)!=null&&g.smart&&y.push(q(m(f({},e),{sizes:t.sizes,size:i,placement_id:(l=s==null?void 0:s.ssps)==null?void 0:l.smart,transaction_id:t.transactionId,bid_id:t.bidId,ad_unit_code:t.adUnitCode,deepSetValue:e.deepSetValue,data:e,bidRequest:t}))),(V=s==null?void 0:s.ssps)!=null&&V.pubmatic&&y.push(ee(m(f({},e),{size:i,placement_id:(j=s==null?void 0:s.ssps)==null?void 0:j.pubmatic,transaction_id:t.transactionId,bid_id:t.bidId,ad_unit_code:t.adUnitCode,data:e,bidRequest:t}))),(C=s==null?void 0:s.ssps)!=null&&C.magnite&&y.push(te(m(f({},e),{size:i,placement_id:(U=s==null?void 0:s.ssps)==null?void 0:U.magnite,ad_unit_code:t.adUnitCode,data:e,bidRequest:t,placement:s}))),!y.length)return o;let u=await Promise.all(y);if(u===null||!(u!=null&&u.length))return o;if(u=u.filter(h=>h&&h.cpm),u!=null&&u.length){(A=u[0])!=null&&A.is_pa||u.sort((O,b)=>((b==null?void 0:b.cpm)||0)-((O==null?void 0:O.cpm)||0));let h=u[0];return M(h),h.bid_id=t.bidId,h.size=i,h.placement_id=_,h}else return o}catch(_){return v(_),o}}))}async function Z(e){let n=e.endpoint_url,t=e.request_id,[o,i]=await Promise.all([X(e),Q()]);e.consent=i,e.placements_info=o,performance.mark("lucead-start");let p=null;try{p=await Y(e)}catch(r){v(r)}performance.mark("lucead-end"),w(D,p,performance.measure("lucead-all-responses","lucead-start","lucead-end")),fetch(`${n}/prebid/pub`,{method:"POST",contentType:"text/plain",body:JSON.stringify({request_id:t,responses:p,is_sra:e.is_sra})}).catch(v)}var I=location.hash.includes("mock");async function K({data:e,bidRequest:n,prebid_version:t,size:o,placement_id:i}){var a,d;let p=I?"?mock=improve":"https://ad.360yield.com/pb",r=k(e,n);r.imp[0].ext.bidder={placementId:i||22511670},r.ext={improvedigital:{sdk:{name:"pbjs",version:t||"8.32.0"}}};try{performance.mark("lucead-improve-start");let c=await S(p,{method:"POST",contentType:"text/plain",body:JSON.stringify(r)});return c.status!==200||(c=await c.json(),!((d=(a=c==null?void 0:c.seatbid[0])==null?void 0:a.bid[0])!=null&&d.price))?null:(performance.mark("lucead-improve-end"),x(c,o,"improve"))}catch(c){return null}}async function R({size:e,placement_id:n,data:t,bidRequest:o}){let i=I?"?mock=grid":"https://grid.bidswitch.net/hbjson",p=k(t,o);p.imp[0].tagid=n.toString();try{let r=await S(i,{method:"POST",contentType:"text/plain",body:JSON.stringify(p)});return r.status!==200?(w("Grid response not ok",r),null):(r=await r.json(),x(r,e,"grid"))}catch(r){return null}}async function q({placement_id:e,sizes:n,size:t,prebid_version:o,transaction_id:i,bid_id:p,ad_unit_code:r,consent:a}){let d="https://prg.smartadserver.com/prebid/v1",c=e.toString().split(":").map(l=>parseInt(l));if(c.length<3)return null;let g={siteid:c[0]||351627,pageid:c[1]||1232283,formatid:c[2]||88269,ckid:c[3]||0,tagId:r,pageDomain:location.href,transactionId:i,timeout:3e3,bidId:p,prebidVersion:o||"8.37.0",schain:pbjs.getConfig("schain"),gpid:r,sizes:n.map(l=>({w:l[0],h:l[1]})),bidfloor:0,gdpr_consent:(a==null?void 0:a.tcString)||null};try{let l=await S(d,{method:"POST",contentType:"text/plain",body:JSON.stringify(g)});return!l.ok||l.status!==200||l.headers.get("content-length")==="0"?(w("Response not ok",l),null):(l=await l.json(),l?{cpm:(l==null?void 0:l.cpm)||0,currency:(l==null?void 0:l.currency)||"USD",ad:l!=null&&l.ad?T(l.ad):null,size:{width:l.width||t.width,height:l.height||t.height},ssp:"smart"}:null)}catch(l){return null}}async function ee({placement_id:e,size:n,data:t,bidRequest:o}){let i=I?"?mock=pubmatic":"https://hbopenbid.pubmatic.com/translator?source=prebid-client",[p,r]=e.toString().split(":"),a=k(t,o);a.at=1,a.cur=["USD"],a.imp[0].tagid=r,a.imp[0].secure=1,a.imp[0].banner.pos=0,a.site.publisher.id=p;try{let d=await S(i,{method:"POST",contentType:"text/plain",body:JSON.stringify(a)});return d.ok?(d=await d.json(),x(d,n,"pubmatic")):(w("Response not ok",d),null)}catch(d){return null}}async function te({placement_id:e,size:n,ad_unit_code:t,data:o,bidRequest:i,placement:p}){let r=I?"?mock=magnite":"https://prebid-server.rubiconproject.com/openrtb2/auction",a=e.toString().split(":").map(c=>parseInt(c));if(a.length<3)return null;let d=k(o,i);d.imp[0].ext.prebid={bidder:{rubicon:{video:{},accountId:a[0],siteId:a[1],zoneId:a[2]}},adunitcode:t};try{let c=await S(r,{method:"POST",contentType:"text/plain",body:JSON.stringify(d)});return c.ok?(c=await c.json(),x(c,n,"magnite",p)):null}catch(c){return null}}window.ayads_prebid=Z;window.ayads_prebid_data&&(window.ayads_prebid(window.ayads_prebid_data),delete window.ayads_prebid_data);(location.hostname==="www.24h.com.vn"||location.hostname==="localhost")&&L();})();
