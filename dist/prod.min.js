(()=>{var F=Object.defineProperty,H=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var z=(e,n,t)=>n in e?F(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,h=(e,n)=>{for(var t in n||(n={}))X.call(n,t)&&z(e,t,n[t]);if(M)for(var t of M(n))Y.call(n,t)&&z(e,t,n[t]);return e},_=(e,n)=>H(e,Q(n));function y(){console.log("%cLucead","background:#444;color:#4EA05D;border-radius:4px;padding:2px",...arguments)}function v(){console.error("%cLucead","background:#444;color:#4EA05D;border-radius:4px;padding:2px",...arguments)}var x="storage";function L(e){x=e}function Z(){let e=JSON.parse(localStorage.getItem(x))||{};for(let n in e)if(e.hasOwnProperty(n)){let t=e[n][1]||0;t&&t<N()&&(delete e[n],b(n,null))}return e}function C(e){let n=Z();return n[e]&&n[e][0]||null}function b(e,n,t){let o=JSON.parse(localStorage.getItem(x))||{};n?o[e]=[n,t?N()+t:0]:delete o[e],localStorage.setItem(x,JSON.stringify(o)),K()}function W(e){b(e,null)}function N(){return Math.floor(Date.now()/1e3)}function K(){let e=JSON.parse(localStorage.getItem(x));for(let n in e)if(e.hasOwnProperty(n)){let t=e[n][1]||0;t&&t<N()&&delete e[n]}localStorage.setItem(x,JSON.stringify(e))}var q="v0608.1",ee=1500,te=!0,B=!0;function U(e){return"response-"+e}function ne(e){let n=window.chrome,t=window.navigator,o=t.vendor,r=typeof window.opr!="undefined",d=t.userAgent.indexOf("Edg")>-1;if(t.userAgent.match("CriOS"))y("Chrome on IOS");else if(!(n!==null&&typeof n!="undefined"&&o==="Google Inc."&&r===!1&&d===!1))return;let l="lucead:features:mesured2";if(localStorage.getItem(l))return;let p="runAdAuction"in navigator,a=`${e}/report/features?pa=${p?1:0}&domain=${location.hostname}`,u=document.createElement("iframe");u.id="lucead-measure-features",u.src=a,u.style.display="none",document.body.appendChild(u),localStorage.setItem(l,"1")}async function I(e,n={}){let{timeout:t=ee}=n,o=new AbortController,r=setTimeout(()=>o.abort(),t),d=await fetch(e,_(h({},n),{signal:o.signal,credentials:"include"}));return clearTimeout(r),d}function j(e){return e?e.includes("<html")?e:`<html lang="en"><body style="margin:0;background-color:#FFF">${e}</body></html>`:null}function O(e,n){var o,r,d,i,l,p;let t=e.ortbConverter({}).toORTB({bidRequests:[n],bidderRequest:e.bidderRequest});if(e.consent?(e.deepSetValue(t,"user.ext.consent",(o=e==null?void 0:e.consent)==null?void 0:o.tcString),e.deepSetValue(t,"regs.ext.gdpr",(r=e==null?void 0:e.consent)!=null&&r.gdprApplies?1:0)):e.deepSetValue(t,"regs.ext.gdpr",0),(d=t.imp)!=null&&d.length)for(let a of t.imp)a.banner.w=n.sizes[0][0],a.banner.h=n.sizes[0][1];return(l=(i=t==null?void 0:t.source)==null?void 0:i.ext)!=null&&l.wrapper||(e.deepSetValue(t,"source.ext.wrapper","Prebid_js"),e.deepSetValue(t,"source.ext.wrapper_version",(e==null?void 0:e.prebid_version)||((p=window==null?void 0:window.pbjs)==null?void 0:p.version))),n!=null&&n.userIdAsEids&&e.deepSetValue(t,"user.ext.eids",n.userIdAsEids),e.deepSetValue(t,"device.js",1),e.deepSetValue(t,"at",1),e.deepSetValue(t,"cur",["USD"]),e.deepSetValue(t,"source.ext.schain",pbjs.getConfig("schain")),t}function k(e,n,t=null){var d;if(!((d=e==null?void 0:e.seatbid)!=null&&d.length))return null;let o=e.seatbid[0].bid.filter(i=>i&&i.price>0&&i.adm&&i.w===n.width&&i.h===n.height);o.sort((i,l)=>l.price-i.price);let r=o[0];return{cpm:(r==null?void 0:r.price)||0,currency:e.cur||"USD",ad:j((r==null?void 0:r.adm)||null),size:{width:(r==null?void 0:r.w)||n.width,height:(r==null?void 0:r.h)||n.height},ssp:t,advertiser_domains:(r==null?void 0:r.adomain)||null}}async function re(){return new Promise(e=>{window.__tcfapi?window.__tcfapi("getTCData",2,(n,t)=>{e(t?n:null)}):e(null)})}async function oe(e){try{return await fetch(`${e.static_url}/prebid/site?p=`+e.bidRequests[0].params.placementId).then(n=>n.json())}catch(n){return null}}async function ie({base_url:e,size:n,placement_id:t,bidRequest:o,bidderRequest:r,floor:d,is_sra:i,endpoint_url:l}){n||(n={width:300,height:250});let p=e,a={seller:p,decisionLogicUrl:`${p}/js/ssp.js`,interestGroupBuyers:[p],auctionSignals:{size:n,placement_id:t},requestedSize:n,allSlotsRequestedSizes:[n],sellerSignals:{},sellerTimeout:1e3,sellerCurrency:"EUR",perBuyerSignals:{[p]:{prebid_bid_id:o==null?void 0:o.bidId,prebid_request_id:r==null?void 0:r.bidderRequestId,placement_id:t,floor:d,is_sra:i,endpoint_url:l}},perBuyerTimeouts:{"*":1e3},resolveToConfig:!1,dataVersion:2,deprecatedReplaceInURN:{"${PLACEMENT_ID}":t,"${DOMAIN}":location.hostname}},u;if(!navigator.runAdAuction||location.hash.includes("skip-pa")?u=null:u=await navigator.runAdAuction(a),u){if(await navigator.deprecatedReplaceInURN(u,{"${PLACEMENT_ID}":t,"${DOMAIN}":location.hostname}),te){let c=document.createElement("iframe");c.src=u,c.style.display="none",document.body.appendChild(c),c.remove()}return{bid_id:o==null?void 0:o.bidId,ad:j(`<iframe src="${u}" style="width:${n.width}px;height:${n.height}px;border:none" seamless ></iframe>`),size:n,is_pa:!0,placement_id:t}}else return null}async function se(e){let n=e.site;return await Promise.all(e.bidRequests.map(async t=>{var d,i,l,p,a,u,c,P,E,D,J,$;let o={bid_id:t==null?void 0:t.bidId,bid:0,ad:null,size:null,placement_id:e.placement_id};if(((d=t==null?void 0:t.params)==null?void 0:d.enableContextual)===!1)return o;let r={width:t.sizes[0][0]||300,height:t.sizes[0][1]||250};try{let m=(i=t==null?void 0:t.params)==null?void 0:i.placementId;if(!m)return o;let G=await ie(_(h({},e),{size:r,placement_id:m,data:e,bidRequest:t}));if(G)return G;let s=n.placements[m]||null;if(!(s!=null&&s.ssps))return y("No placement",m),o;if(B){let f=C(U(m));if(f)return f.bid_id=t.bidId,f}let w=[];if((l=s==null?void 0:s.ssps)!=null&&l.improve&&w.push(ce(_(h({},e),{size:r,placement_id:(p=s==null?void 0:s.ssps)==null?void 0:p.improve,data:e,bidRequest:t}))),(a=s==null?void 0:s.ssps)!=null&&a.grid&&w.push(le(_(h({},e),{size:r,placement_id:s==null?void 0:s.ssps.grid,deepSetValue:e.deepSetValue,data:e,bidRequest:t}))),(u=s==null?void 0:s.ssps)!=null&&u.smart&&w.push(ae(_(h({},e),{sizes:t.sizes,size:r,placement_id:(c=s==null?void 0:s.ssps)==null?void 0:c.smart,transaction_id:t.transactionId,bid_id:t.bidId,ad_unit_code:t.adUnitCode,deepSetValue:e.deepSetValue,data:e,bidRequest:t}))),(P=s==null?void 0:s.ssps)!=null&&P.pubmatic&&w.push(pe(_(h({},e),{size:r,placement_id:(E=s==null?void 0:s.ssps)==null?void 0:E.pubmatic,transaction_id:t.transactionId,bid_id:t.bidId,ad_unit_code:t.adUnitCode,data:e,bidRequest:t}))),(D=s==null?void 0:s.ssps)!=null&&D.magnite&&w.push(de(_(h({},e),{size:r,placement_id:(J=s==null?void 0:s.ssps)==null?void 0:J.magnite,ad_unit_code:t.adUnitCode,data:e,bidRequest:t,placement:s}))),!w.length)return o;let g=await Promise.all(w);if(g===null||!(g!=null&&g.length))return o;if(g=g.filter(f=>f&&f.cpm),g!=null&&g.length){($=g[0])!=null&&$.is_pa||g.sort((S,A)=>((A==null?void 0:A.cpm)||0)-((S==null?void 0:S.cpm)||0));let f=g[0];if(f.bid_id=t.bidId,f.size=r,f.placement_id=m,B){let S=`<script>top.lucead_rendered("${m}")<\/script>`;f.ad.includes("</body>")?f.ad=f.ad.replace("</body>",S+"</body>"):f.ad+=S,b(U(m),f,86400)}return f}else return o}catch(m){return v(m),o}}))}async function V(e){let n=e.endpoint_url.replace("/go",""),t=e.request_id;e.site=window.lucead_site||await oe(e),e.consent=await re(),y("Lucead for Prebid ",q,e);let o=null;try{o=await se(e)}catch(r){v(r)}fetch(`${n}/go/prebid/pub`,{method:"POST",contentType:"text/plain",body:JSON.stringify({request_id:t,responses:o,is_sra:e.is_sra})}).catch(v),ne(e.base_url)}window.lucead_rendered=function(e){let n=U(e);y("rendered",e,C(n)),W(n)};var T=location.hash.includes("mock");async function ce({data:e,bidRequest:n,prebid_version:t,size:o,placement_id:r}){var l,p;let d=T?"?mock=improve":"https://ad.360yield.com/pb",i=O(e,n);i.imp[0].ext.bidder={placementId:r||22511670},i.ext={improvedigital:{sdk:{name:"pbjs",version:t||"8.32.0"}}};try{performance.mark("lucead-improve-start");let a=await I(d,{method:"POST",contentType:"text/plain",body:JSON.stringify(i)});return a.status!==200||(a=await a.json(),!((p=(l=a==null?void 0:a.seatbid[0])==null?void 0:l.bid[0])!=null&&p.price))?null:(performance.mark("lucead-improve-end"),k(a,o,"improve"))}catch(a){return null}}async function le({size:e,placement_id:n,data:t,bidRequest:o}){let r=T?"?mock=grid":"https://grid.bidswitch.net/hbjson",d=O(t,o);d.imp[0].tagid=n.toString();try{let i=await I(r,{method:"POST",contentType:"text/plain",body:JSON.stringify(d)});return i.status!==200?(y("Grid response not ok",i),null):(i=await i.json(),k(i,e,"grid"))}catch(i){return null}}async function ae({placement_id:e,sizes:n,size:t,prebid_version:o,transaction_id:r,bid_id:d,ad_unit_code:i,consent:l}){let p="https://prg.smartadserver.com/prebid/v1",a=e.toString().split(":").map(c=>parseInt(c));if(a.length<3)return null;let u={siteid:a[0]||351627,pageid:a[1]||1232283,formatid:a[2]||88269,ckid:a[3]||0,tagId:i,pageDomain:location.href,transactionId:r,timeout:3e3,bidId:d,prebidVersion:o||"8.37.0",schain:pbjs.getConfig("schain"),gpid:i,sizes:n.map(c=>({w:c[0],h:c[1]})),bidfloor:0,gdpr_consent:(l==null?void 0:l.tcString)||null};try{let c=await I(p,{method:"POST",contentType:"text/plain",body:JSON.stringify(u)});return!c.ok||c.status!==200||c.headers.get("content-length")==="0"?(y("Response not ok",c),null):(c=await c.json(),c?{cpm:(c==null?void 0:c.cpm)||0,currency:(c==null?void 0:c.currency)||"USD",ad:c!=null&&c.ad?j(c.ad):null,size:{width:c.width||t.width,height:c.height||t.height},ssp:"smart"}:null)}catch(c){return null}}async function pe({placement_id:e,size:n,data:t,bidRequest:o}){let r=T?"?mock=pubmatic":"https://hbopenbid.pubmatic.com/translator?source=prebid-client",[d,i]=e.toString().split(":"),l=O(t,o);l.at=1,l.cur=["USD"],l.imp[0].tagid=i,l.imp[0].secure=1,l.imp[0].banner.pos="0",l.site.publisher.id=d;try{let p=await I(r,{method:"POST",contentType:"text/plain",body:JSON.stringify(l)});return p.ok?(p=await p.json(),k(p,n,"pubmatic")):(y("Response not ok",p),null)}catch(p){return null}}async function de({placement_id:e,size:n,ad_unit_code:t,data:o,bidRequest:r,placement:d}){let i=T?"?mock=magnite":"https://prebid-server.rubiconproject.com/openrtb2/auction",l=e.toString().split(":").map(a=>parseInt(a));if(l.length<3)return null;let p=O(o,r);p.imp[0].ext.prebid={bidder:{rubicon:{video:{},accountId:l[0],siteId:l[1],zoneId:l[2]}},adunitcode:t};try{let a=await I(i,{method:"POST",contentType:"text/plain",body:JSON.stringify(p)});return a.ok?(a=await a.json(),k(a,n,"magnite",d)):null}catch(a){return null}}function ue(){L("lucead"),window.lucead_prebid_data?V(window.lucead_prebid_data):(window.ayads_prebid=V,window.lucead_prebid=V)}ue();})();
